#include "bsp_init.h"

//这个数组用于位选,只给一个引脚高电平
const char which[] = {0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80};
//段选,根据数字编码
const char num[] = {0xc0, 0xf9, 0xa4, 0xb0, 0x99, 0x92, 0x82, 0xf8, 0x80, 0x90, 0x7f, 0xc1, 0x8e}; //10.  11U 	12F

void delay(unsigned int i)
{
	while (i--)
		;
}

void bsp_init(void)
{
	P0 = 0xff;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;

	P0 = 0;
	P2 &= 0x1F;
	P2 |= 0xA0;
	P2 &= 0x1f;
}

void bsp_smg(unsigned char n, unsigned char m)
{
	P0 = which[n - 1];
	P2 = P2 = P2 & 0x1f | 0xC0; //位选
	P2 &= 0x1f;

	P0 = num[m];
	P2 = P2 & 0x1f | 0xE0; //段选

	delay(150);
	P0 = 0xff; //消隐

	P2 &= 0x1f;
}
//LED on
void LED_1()
{
	P0 &= 0xfe;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_2()
{
	P0 &= 0xfd;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_3()
{
	P0 &= 0xfb;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_4()
{
	P0 &= 0xf7;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_5()
{
	P0 &= 0xef;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}

//LED off
void LED_1_OFF()
{
	P0 |= 0x01;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_2_OFF()
{
	P0 |= 0x02;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_3_OFF()
{
	P0 |= 0x04;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_4_OFF()
{
	P0 |= 0x08;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}
void LED_5_OFF()
{
	P0 |= 0x10;
	P2 &= 0x1F;
	P2 |= 0x80;
	P2 &= 0x1f;
}